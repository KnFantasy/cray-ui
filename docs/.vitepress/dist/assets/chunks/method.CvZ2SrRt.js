import{D as B,i as z,z as E,E as L,G as N,d as R,h as f,l,H as T,o as x,f as h,w as b,m as D,a as g,n as M,I as Z,j as O,x as I,c as $,b as S,B as A,v as j,T as G,J as H,C as J,K as w}from"./framework.BX0NulVQ.js";import{R as K}from"./RenderVnode.vue_vue_type_script_lang.5MruYBe8.js";import{_ as P}from"./Icon.vue_vue_type_script_setup_true_lang.B56VepCh.js";function U(n,s,e){B(n)?z(n,(t,a)=>{a==null||a.removeEventListener(s,e),t==null||t.addEventListener(s,e)}):E(()=>{n.addEventListener(s,e)}),L(()=>{var t;(t=N(n))==null||t.removeEventListener(s,e)})}const q={class:"cray-message__content"},F={key:0,class:"cray-message__close"},Q=R({__name:"Message",props:{message:{},duration:{default:3e3},showClose:{type:Boolean},type:{default:"info"},onDestory:{},id:{},zIndex:{},offset:{default:15},transitionName:{default:"fade-up"}},setup(n,{expose:s}){const e=n,t=f(!1),a=f(),u=f(0),m=l(()=>X(e.id)),c=l(()=>e.offset+m.value),p=l(()=>u.value+c.value),v=l(()=>({top:c.value+"px",zIndex:e.zIndex}));let r;function d(){e.duration!==0&&(r=setTimeout(()=>{t.value=!1},e.duration))}function k(){clearTimeout(r)}E(async()=>{t.value=!0,d(),await T(),u.value=a.value.getBoundingClientRect().height});function _(){e.onDestory()}return U(document,"keydown",o=>{o.code==="Escape"&&(t.value=!1)}),s({bottomOffset:p,visible:t}),(o,y)=>(x(),h(G,{name:o.transitionName,onAfterLeave:_},{default:b(()=>[D(g("div",{class:M(["cray-message",{[`cray-message--${o.type}`]:o.type,"is-close":o.showClose}]),role:"alert",ref_key:"messageRef",ref:a,style:Z(v.value),onMouseenter:k,onMouseleave:d},[g("div",q,[O(o.$slots,"default",{},()=>[o.message?(x(),h(K,{key:0,vNode:o.message},null,8,["vNode"])):I("",!0)])]),o.showClose?(x(),$("div",F,[S(P,{onClick:y[0]||(y[0]=A(Y=>t.value=!1,["stop"])),icon:"xmark"})])):I("",!0)],38),[[j,t.value]])]),_:3},8,["name"]))}}),C=f(0),V=(n=100)=>{const s=f(n),e=l(()=>C.value+s.value);return{currentZIndex:e,nextZIndex:()=>(C.value++,e.value),initialZIndex:s}};let W=1;const i=H([]),ne=n=>{const s=document.createElement("div"),e=`message_${W++}`,t=()=>{const r=i.findIndex(d=>d.id===e);r!==-1&&(i.splice(r,1),w(null,s))},a=()=>{const r=i.find(d=>d.id===e);r&&(r.vm.exposed.visible.value=!1)},{nextZIndex:u}=V(),m={...n,id:e,zIndex:u(),onDestory:t},c=J(Q,m);w(c,s),document.body.appendChild(s.firstElementChild);const p=c.component,v={id:e,vnode:c,vm:p,props:m,destory:a};return i.push(v),v},X=n=>{const s=i.findIndex(e=>e.id===n);return s<=0?0:i[s-1].vm.exposed.bottomOffset.value},oe=()=>{i.forEach(n=>{n.destory()})};export{oe as a,ne as c};
